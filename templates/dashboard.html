{{define "content"}}
<!-- Welcome Message -->
<div class="card">
    <div class="card-header">
                    <h2 class="card-title">Welcome to EoD Scheduler</h2>
        <p class="card-description">Your central hub for managing engineer on duty schedules</p>
    </div>
    <div class="flex-between">
        <div>
            <p>Manage your team's schedule rotation efficiently with automated scheduling and manual overrides.</p>
        </div>
        <div class="current-time" style="font-weight: 600; color: #2c3e50;"></div>
    </div>
</div>

<!-- Current Week Schedule - Prominent Section -->
<div class="card card-featured">
    <div class="card-header">
        <h2 class="card-title">This Week's Schedule</h2>
        <p class="card-description">Current duty assignments for this week</p>
    </div>
        {{if .Data.CurrentWeek}}
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Team Member</th>
                        <th>Hours</th>
                        <th>Type</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Data.CurrentWeek}}
                    <tr{{if .IsToday}} class="today-highlight"{{end}}>
                        <td><strong>{{.GetFormattedDate}}{{if .IsToday}} <span class="today-badge">Today</span>{{end}}</strong></td>
                        <td>
                            <span class="font-semibold">{{.TeamMemberName}}</span>
                        </td>
                        <td>
                            <span class="font-mono font-semibold">
                                {{.StartTime}} - {{.EndTime}}
                            </span>
                        </td>
                        <td>
                            {{if .IsManualOverride}}
                            <span class="text-sm font-medium" style="color: var(--warning-600);">
                                Manual Override
                            </span>
                            {{else}}
                            <span class="text-sm font-medium" style="color: var(--success-600);">
                                Auto-Generated
                            </span>
                            {{end}}
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{else}}
        <div class="empty-day">
            <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.6;">âˆŽ</div>
            <h3>No schedule for this week</h3>
            <p>Generate a schedule to get started with duty assignments.</p>
            <form method="post" action="/schedule/generate" style="display: inline;">
                <input type="hidden" name="redirect" value="/">
                <button type="submit" class="btn mt-2" onclick="return confirm('Generate schedule for the next 3 months?')">Generate Schedule</button>
            </form>
        </div>
        {{end}}
</div>


<!-- Next Two Weeks -->
{{if .Data.NextWeeks}}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">Next Two Weeks</h2>
    </div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Day</th>
                    <th>Team Member</th>
                    <th>Hours</th>
                    <th>Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Data.NextWeeks}}
                <tr>
                    <td>{{.GetFormattedDate}}</td>
                    <td>{{.GetWeekday}}</td>
                    <td>{{.TeamMemberName}}</td>
                    <td>{{.StartTime}} - {{.EndTime}}</td>
                    <td>
                        {{if .IsManualOverride}}
                        <span style="color: #f39c12;">Manual Override</span>
                        {{else}}
                        <span style="color: #27ae60;">Auto-Generated</span>
                        {{end}}
                    </td>
                    <td>
                        <a href="/schedule/edit/{{.ID}}?redirect=/" class="btn btn-small btn-secondary">Edit</a>
                        {{if .IsManualOverride}}
                        <form style="display: inline;" method="post" action="/schedule/remove/{{.ID}}"
                            onsubmit="return confirm('Remove this manual override?')">
                            <input type="hidden" name="redirect" value="/">
                            <button type="submit" class="btn btn-small btn-danger">Remove Override</button>
                        </form>
                        {{end}}
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
</div>
{{end}}

<!-- Hidden form for JavaScript generate function -->
<form method="post" action="/schedule/generate" style="display: none;">
    <input type="hidden" name="redirect" value="/">
    <button type="submit">Generate Schedule</button>
</form>

<style>
    .btn-group .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
    }
    
    .btn-group .btn:active {
        transform: translateY(0);
        box-shadow: 0 1px 2px rgba(0,0,0,0.1) !important;
    }
    
    @media (max-width: 768px) {
        .btn-group {
            flex-direction: column !important;
            align-items: stretch !important;
        }
        
        .btn-group .btn {
            width: 100% !important;
            justify-content: center !important;
        }
    }
</style>

<script>
    function generateSchedule() {
        if (confirm('Generate schedule for the next 3 months?')) {
            document.querySelector('form[action="/schedule/generate"] button').click();
        }
    }

    // Show success/error messages from URL params
    document.addEventListener('DOMContentLoaded', function () {
        const urlParams = new URLSearchParams(window.location.search);
        const error = urlParams.get('error');
        const success = urlParams.get('success');

        if (error) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'message message-error';
            errorDiv.textContent = error;
            document.querySelector('main .container').insertBefore(errorDiv, document.querySelector('.page-header'));
        }

        if (success) {
            const successDiv = document.createElement('div');
            successDiv.className = 'message message-success';
            successDiv.textContent = success;
            document.querySelector('main .container').insertBefore(successDiv, document.querySelector('.page-header'));
        }
    });
</script>
{{end}}